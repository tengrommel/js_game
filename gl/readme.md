# webGL
> body onload

# 3D图形学
- 3D坐标系
- 网格、多边形和顶点
> 网格是由一个或者多个多边形组成的物体，各个顶点的坐标(x,y,z)定义了多边形在3D空间中的位置
- 材质、纹理和光源
    - 1、网格表面可以由一个或者多个位图来决定，这就是通常所说的纹理映射简称纹理
    - 2、大多数的图形系统中，网格表面的特性被统称为材质，材质通常依赖一个或者多个光源来呈现外观效果
- 变换与矩阵
    - 3D网格的形状由顶点位置确定
    - 变换包含对渲染模型的缩放、旋转、位移等操作
    - 变换通常时由矩阵来操作的
- 相机、透视、视口和投影
    - 相机来定义用户和场景的相对朝向
    - 视野尺寸决定了透视关系
    - 视口是由浏览器或canvas元素决定的
    - 投影矩阵是将相机空间的3D坐标转为视口中的2D绘制空间的坐标
- 着色器
    - 为了在最终的图像中渲染模型，精确定义顶点、变换、材质、光源和相机之间的关系和交互。这就用到着色器
    - 着色器通常由高等级的类C语言编写，编译并运行在图形处理单元（GPU）中。
    当我们编写WEBGL程序的时候，必须定义着色器，否则图形不会显示在屏幕上

# webgl概述
    
    
- webGL的定义
    - 网页上绘制和渲染3D图形的技术
    - 内嵌在浏览器
    - 多平台运行
    - "Web版的OpenGL"

- 使用attribute、unifrom变量
    - 使用attribute绘制一个点
    - attribute变量传输的是与顶点相关的数据
    - 主要操作步骤：
        - A、在顶点着色器中声明attribute变量
        - B、将attribute变量赋值给JS变量
        - C、向attribute变量传输数据

- WebGL缓冲区对象
    - WebGL提供了方便的机制，可以进行一次性向着色器传入多个顶点的数据，叫做缓冲区对象
    - 缓冲区对象是WebGL的一块存储区，创建后才能向其中写入顶点数据
    - 操作步骤
        - A、创建缓冲区对象
        - B、绑定缓冲区对象
        - C、将数据写入缓冲区
        - D、给缓冲区对象分配一个attribute变量
        - E、开启attribute变量

- WebGL图形绘制
    - 绘制点
    - 绘制线段、线段带、回路 
    - 绘制三角形
    - 利用三角带绘制平行四边形
    - 利用三角扇绘制一个六边形
    
- WebGL 变换
    - 1、平移
    > 平移时对顶点的每个分量加上对应轴上的平移距离
    - 2、缩放
    > 缩放是对顶点的每个分量倍数放大或者缩小
    - 3、旋转
    > 旋转需指明：旋转轴、旋转方向、旋转角度

- WebGL 矩阵变换
    - 1、平移
    - 2、缩放
    - 3、旋转
    
# WebGL　动画基础
 
- 矩阵复合变换
- 动画基础
    
>变换要求：先平移后旋转

变换步骤：
- 1、将各个变换矩阵封装到帮助类Matrix.js中
- 2、着色器中定义uniform变量的变换矩阵
- 3、获取program中相关的uniform变量的位置
- 4、往变换矩阵中赋值

矩阵相乘：想先做哪个操作就先乘哪一个，靠近原坐标先做

动画的关键：不断擦除重绘，每次重绘轻微改变顶点位置

动画关键的机制：
- 机制一，在每一个t时反复调用同一个函数绘制
- 机制二，在每次绘制之前，清除上次绘制的内容，并作出相关变换

# WebGL 颜色与纹理
- 1、将非坐标数据传入顶点着色器
- 2、vertexAttribPointer()的步进和偏移参数
- 3、varying变量、绘制彩色三角形
- 4、在矩形表面上贴上图像
- 5、使用多幅纹理

varying变量的作用时从顶点着色器向片元着色器中传输数据

>顶点着色器与片元着色器中有类型和命名都相同的varying变量，顶点着色器赋给该变量的值就会被自动传入片元着色器

- 纹理映射就是将一张图像映射到一个几何图形的表面上去
- 这张被贴的图称为纹理或者纹理图像
- 组成纹理图像的像素又被称为纹素

步骤
- 1、准备好纹理图像
- 2、为几何图形配置纹理映射方式
- 3、加载图像，配置以便于WEBGL使用
- 4、在片元着色器中将相应的纹素抽出来，将颜色赋给元片

纹理坐标在WEBGL中是二维的，为了获取纹素的颜色

*****配置和加载纹理的步骤*****
- １、创建纹理对象 createTexture()
- ２、加载图片 Image.onload()
- ３、图像y轴反转 pixelStorei()
- ４、激活纹理单元 activeTexture()
- ５、绑定纹理对象 bindTexture()
- ６、配置纹理参数 texParameteri()
- ７、将纹理图像分配给纹理对象 texImage2D()
- ８、将纹理单元传递给片元着色器 uniformli()


